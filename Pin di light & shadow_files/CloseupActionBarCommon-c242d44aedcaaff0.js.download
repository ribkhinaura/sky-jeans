"use strict";(self.legacyJsonp=self.legacyJsonp||[]).push([["55759"],{523226:function(e,t,n){n.r(t),n.d(t,{default:function(){return Z}});var r=n(586659),o=n(797902),i=n(20256),a=n(414772),l=n(693875),c=n(502447),s=n(934645),u=n(878709),d=n(346955),p=n(355940),f=n(821342),y=n(595935),m=n(15667),g=n(378888),b=n(448505),h=n(7872),v=n(611499),j=n(601686),w=n(790427),x=n(25837),P=n(310916),S=n(78762),O=n(382718);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return k(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var E=(0,S.Z)(function(){return Promise.all([n.e("9516"),n.e("82519"),n.e("95853"),n.e("64701")]).then(n.bind(n,358276))},void 0,function(e){return 358276},"SaveAffordance",function(e){return ["9516","82519","95853","64701"]}),T=(0,S.Z)(function(){return n.e("73301").then(n.bind(n,115649))},void 0,function(e){return 115649},"PostDownloadUpsellPopover",function(e){return ["73301"]}),I=(0,S.Z)(function(){return Promise.resolve().then(n.bind(n,11919))},void 0,function(e){return 11919},"SecondarySendButtonCommon",function(e){return []}),A=(0,S.Z)(function(){return Promise.all([n.e("25418"),n.e("58000"),n.e("96415")]).then(n.bind(n,377733))},void 0,function(e){return 377733},"ReactionPickerContainer",function(e){return ["25418","58000","96415"]}),B=(0,S.Z)(function(){return n.e("8419").then(n.bind(n,20262))},void 0,function(e){return 20262},"CloseupCommentButton",function(e){return ["8419"]}),R=(0,r.memo)(function(e){var t,n,S,C,_,k,R,Z=e.goBack,M=e.gridDescription,F=e.isDeletedStoryPin,L=e.inCommentsImprovedDropdownExp,U=e.inCommentsPopoverExp,z=e.isEligibleForAggregatedComments,W=e.isEligibleForPinReactions,Y=e.isOnSecretBoard,G=e.onEditSubmit,H=e.pin,N=e.viewParameter,K=e.viewType,J=e.onSaveButtonClick,q=e.showRepinOnInitialRender,X=e.isStoryPin,$=e.actionBarContainerRef,Q=e.outerPaddingSize,V=void 0===Q?v.g9:Q,ee=e.maxWidth,et=e.showLeadPin,en=e.scrollContainerRef,er=(0,o.TH)(),eo=(0,b.Z)(),ei=(0,P.Yh)(!0).showEnabledSaveBehavior,ea=(0,u.G)().imgSrc,el=(0,j.x4)(),ec=el.clientTrackingParams,es=el.showCloseupContentRight,eu=el.closeupWithinMasonryEnabled,ed=el.peekCloseupEnabled,ep=(0,d.SU)(),ef=ep.viewType,ey=ep.viewParameter,em=(0,f.Z)(),eg=(0,h.q6)(em,null==H||null==(t=H.pinner)?void 0:t.id,eo),eb=(0,s.Z)({showProductDetailPage:!!H.is_eligible_for_pdp}),eh=D((0,r.useState)(!!(0,g.mB)(er.search).share),2),ev=eh[0],ej=eh[1],ew=D((0,r.useState)(!1),2),ex=ew[0],eP=ew[1],eS=(0,a.tS)(),eO=eS.shareFromPostDownloadUpsell,eC=eS.setShareFromPostDownloadUpsell,e_=eS.saveToBoardFromPostDownloadUpsell,eD=eS.setSaveToBoardFromPostDownloadUpsell;(0,r.useEffect)(function(){eO&&(ej(!0),eC(!1))},[eO,eC]);var ek=(0,r.useCallback)(function(e){return eP(e)},[]),eE=(0,r.useCallback)(function(){return ej(!1)},[]),eT=(0,r.useCallback)(function(){return ej(function(e){return!e})},[]),eI=(null==(n=H.board)||null==(S=n.owner)?void 0:S.id)||(null==(C=H.pinner)?void 0:C.id),eA=H.aggregated_pin_data,eB=H.comments_disabled,eR=H.reaction_counts,eZ=(0,m.B)().isRTL,eM=eu?ee:ee||v.Gg,eF=(0,c.Z)({pinKey:{type:"Legacy",data:H},orbacActingAs:eo,viewer:em}),eL=!!Object.keys(eR||{}).length,eU=null!=(_=null==eA||null==(k=eA.did_it_data)?void 0:k.images_count)?_:0,ez=(null!=(R=null==eA?void 0:eA.comment_count)?R:0)+eU,eW=Y||F?null:(0,O.jsx)(p.Z,{name:"CloseupActionBar_SecondarySendButton",children:(0,O.jsx)(I,{closeupWithinMasonryEnabled:eu,controllerOptions:{flyoutDisplayOptions:eu?{shownWithinProfileHeader:!0,idealDirection:"down",forceDirection:!0}:{wrapperPosition:"fixed"},isFlyoutOpen:ev,loggingOptions:{component:194,element:72,viewParameter:N||ey,viewType:K||ef},onFlyoutDismiss:eE,onToggleFlyout:eT,sendObject:{type:"pin",description:M,id:H.id,imageUrl:ea,ownerId:eI,url:"/pin/".concat(H.id,"/"),clientTrackingParams:ec}},showSendAnimation:!0})}),eY=(0,O.jsx)(i.xu,{alignItems:"center",color:eu?"transparent":"default","data-test-id":"closeup-action-items",display:"flex",justifyContent:"between",maxWidth:eM,rounding:2,children:(0,O.jsxs)(i.kC,{alignItems:"stretch",gap:2*!!eu,justifyContent:"start",children:[!eg&&!!W&&(0,O.jsx)(p.Z,{name:"CloseupActionBar_ReactionPickerContainer",children:(0,O.jsxs)(i.xu,{alignItems:"center",display:"flex",marginEnd:2*!!eL,children:[(0,O.jsx)(A,{clientTrackingParams:ec,handleReactionTrayHover:ek,idealDirection:eu?"down":void 0,pinId:H.id,reactionByMe:H.reaction_by_me,showTooltip:!0,viewParameter:N,viewType:K}),(0,O.jsx)(y.Z,{pinId:H.id,reactionCounts:eR,showPrettyNumber:!0})]})}),eu&&!(L&&eB)&&(0,O.jsx)(B,{inCommentsImprovedDropdownExp:!!L,inCommentsPopoverExp:!!U,isEligibleForAggregatedComments:!!z,pinKey:{type:"Legacy",data:H},scrollContainerRef:en,shouldShowCommentCount:!eB&&!!ez&&(!!U||!!L),totalCommentCount:ez,viewParameter:N,viewType:K}),eW,(0,O.jsx)(i.xu,{children:(0,O.jsx)(i.xu,{"data-test-id":"closeup-more-options",children:(0,O.jsx)(l.Z,{carouselSlotCurrentIndex:H&&H.carousel_data&&H.carousel_data.index,clientTrackingParams:ec,closeupWithinMasonryEnabled:eu,goBack:Z,isReactionTrayOpen:ex,onEditSubmit:G,pinKey:{type:"Legacy",data:H},showEditPin:!F&&eF,viewParameter:N,viewType:K})})})]})}),eG=eu?void 0:V,eH=(0,O.jsxs)(i.xu,{ref:$,color:"default",dangerouslySetInlineStyle:{__style:{paddingTop:V/2,paddingRight:eZ?void 0:eG,paddingLeft:eZ?eG:void 0,paddingBottom:eu?V/2:void 0,borderRadius:X?"0px 32px 32px 32px":es?"0px 32px 32px 0":void 0}},"data-test-id":"closeup-body-sticky-content",marginTop:eu?0:X?-5:0,width:eu?"100%":void 0,children:[(0,O.jsx)(i.xu,{"data-test-id":"closeupActionBar",marginStart:eb?-3:void 0,children:(0,O.jsxs)(i.kC,{alignItems:"stretch",justifyContent:"between",children:[eY,(0,O.jsx)(i.kC,{alignItems:"center",gap:2,children:!F&&!eg&&(0,O.jsx)(i.xu,{marginStart:3*!eu,children:(0,O.jsx)(E,{boardCount:em.isAuth?em.boardCount:0,clientTrackingParams:ec,onClickCallback:J,pin:H,saveToBoardFromPostDownloadUpsell:e_,setSaveToBoardFromPostDownloadUpsell:eD,showEnabledSaveBehavior:ei,showRepinOnInitialRender:q,variant:"closeup",viewParameter:N,viewType:K})})})]})}),(0,O.jsx)(T,{})]});if(et||eu)return eH;var eN=X&&!ed?x.cI+4:x.hu;return ed&&(eN=0),(0,O.jsx)(i.Le,{top:eN,zIndex:w.mS,children:eH})});function Z(e){return(0,O.jsx)(R,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach(function(t){var r,o;r=t,o=n[t],(r=function(e){var t=function(e,t){if("object"!=C(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=C(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==C(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e))}},595935:function(e,t,n){var r=n(586659),o=n(20256),i=n(149739),a=n(521009),l=n(19585),c=n(709311),s=n(518459),u=n(355919),d=n(821806),p=n(382718);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach(function(t){j(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(h=function(){return!!e})()}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function j(e,t,n){return(t=w(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e){var t=function(e,t){if("object"!=f(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=f(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==f(t)?t:t+""}var x=(0,r.lazy)(function(){return n.e("80948").then(n.bind(n,870828))}),P=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),e&&g(a,e);var t,n,r=(t=h(),function(){var e,n=v(a);return e=t?Reflect.construct(n,arguments,v(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==f(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return b(e)}(this,e)});function a(){var e;if(!(this instanceof a))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return j(b(e=r.call.apply(r,[this].concat(n))),"state",{displayAggregationModal:!1}),j(b(e),"showAggregationModal",function(){var t=e.props,n=t.disableModal,r=t.logContextEvent;n||(e.setState({displayAggregationModal:!0}),r({event_type:101,view_type:3,view_parameter:139,component:13458,element:11435,aux_data:{objectId:e.props.pinId}}))}),j(b(e),"hideAggregationModal",function(){e.setState({displayAggregationModal:!1})}),e}return n=[{key:"render",value:function(){var e=this,t=this.state.displayAggregationModal,n=this.props,r=n.isBold,a=n.isStoryPin,l=n.paddingY,f=n.pinId,y=n.reactionCounts,m=n.showPrettyNumber,g=n.size,b=y?(0,u.At)(y):null,h=y?(0,u.Ud)(y):0,v=!!b&&b.length>0&&b.filter(function(e){return!!s.GY[e]}).map(function(t,n){var r=t&&s.GY[t]?s.GY[t]:"",i=(0,s.fW)(r,e.props.i18n),a=i.label,l=i.gridAsset;return(0,p.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{marginRight:2}},children:(0,p.jsx)(o.xu,{height:19,width:19,children:l&&(0,p.jsx)(o.Ee,{alt:null!=a?a:"",fit:"cover",naturalHeight:1,naturalWidth:1,src:l})})},n)});return(0,p.jsxs)(o.xu,{children:[(0,p.jsx)(o.iP,{accessibilityLabel:"".concat(h," reactions"),dataTestId:"reactions-count-button",onTap:this.showAggregationModal,children:!!v&&(0,p.jsx)(o.xu,{"data-test-id":"aggregated-reactions-container",display:"inlineBlock",children:m?(0,p.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{cursor:"pointer"}},children:(0,p.jsx)(o.xv,{size:null!=g?g:i.n,weight:"bold",children:(0,p.jsx)(c.Z,{shortform:!0,shortformMaximumFractionDigits:1,value:h})})}):(0,p.jsxs)(o.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{cursor:"pointer"}},"data-test-id":"aggregated-reactions-container",direction:"row",display:"flex",height:a?"auto":19,paddingY:null!=l?l:6*!a,children:[(0,p.jsx)(o.kC,{alignItems:"stretch",direction:"row",justifyContent:"start",children:v}),(0,p.jsx)(o.xu,{paddingX:1,children:(0,p.jsx)(o.xv,{color:r?"default":"subtle",size:null!=g?g:i.n,weight:r?"bold":"normal",children:(0,p.jsx)(c.Z,{shortform:!0,shortformMaximumFractionDigits:1,value:h})})})]})})}),t&&h&&(0,p.jsx)(d.Z,{children:(0,p.jsx)(x,{aggregatedReactions:v,onDismiss:this.hideAggregationModal,pinId:f,totalReactionCount:h})})]})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,w(r.key),r)}}(a.prototype,n),Object.defineProperty(a,"prototype",{writable:!1}),a}(r.PureComponent);j(P,"defaultProps",{isBold:!0}),t.Z=function(e){var t=(0,l.Z)(),n=(0,a.Z)();return(0,p.jsx)(P,m(m({},e),{},{i18n:t,logContextEvent:n}))}}}]);