"use strict";(self.legacyJsonp=self.legacyJsonp||[]).push([["58000"],{446655:function(e,t,n){n.d(t,{GY:function(){return j},Jg:function(){return _},bR:function(){return S},fW:function(){return P}});var r,o=n(827427),i=n(770943),a=n(624206),c=n(289714),l=n(707241),s=n(666043),u=n(26619),f=n(585372),d=n(50198),p=n(202511),y=n(181018),h=n(749511),m=n(606166),b=n(906644),g=n(244771),v=n(220134);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t,n){var r;return(r=function(e,t){if("object"!=w(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=w(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==w(r)?r:r+"")in e)?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _=["goodIdea","love","thanks","wow","haha"],j=(x(r={},7,"goodIdea"),x(r,1,"love"),x(r,13,"thanks"),x(r,11,"wow"),x(r,5,"haha"),r),S={goodIdea:"".concat(7),love:"".concat(1),thanks:"".concat(13),wow:"".concat(11),haha:"".concat(5)},P=function(e){var t=e.i18n,n=e.type,r={default:{staticAsset:p},goodIdea:{backgroundColor:"yellow-caramellow-50",staticAsset:a,animatedAsset:o,gridAsset:i,label:t.bt("Ide bagus", "Good idea", "Reaction label to tell a creator that their pin is a good idea", undefined, true),htmlStyle:"\n      @keyframes play90 {\n        0% {\n          background-position: 0px 0px;\n        }\n        100% {\n          background-position: -".concat(7380,"px 0px;\n        }\n      }\n    "),animationStyle:"play90 3000ms steps(90) infinite forwards",type:7},haha:{backgroundColor:"purple-mysticool-100",staticAsset:s,animatedAsset:c,gridAsset:l,label:t.bt("Haha", "Haha", "Reaction label to tell a creator that the pinner laughed because of their pin", undefined, true),htmlStyle:"\n      @keyframes play60 {\n        0% {\n          background-position: 0px 0px;\n        }\n        100% {\n          background-position: -".concat(4920,"px 0px;\n        }\n      }\n    "),animationStyle:"play60 2000ms steps(60) infinite forwards",type:5},love:{backgroundColor:"red-pushpin-100",staticAsset:d,animatedAsset:u,gridAsset:f,label:t.bt("Suka", "Love", "Reaction label to tell a creator that the pinner loved their pin", undefined, true),htmlStyle:"\n      @keyframes play90 {\n        0% {\n          background-position: 0px 0px;\n        }\n        100% {\n          background-position: -".concat(7380,"px 0px;\n        }\n      }\n    "),animationStyle:"play90 3000ms steps(90) infinite forwards",type:1},thanks:{backgroundColor:"teal-spabattical-100",staticAsset:m,animatedAsset:y,gridAsset:h,label:t.bt("Terima kasih", "Thanks", "Reaction label to tell a creator thank you", undefined, true),htmlStyle:"\n      @keyframes play60 {\n        0% {\n          background-position: 0px 0px;\n        }\n        100% {\n          background-position: -".concat(4920,"px 0px;\n        }\n      }\n    "),animationStyle:"play60 2000ms steps(60) infinite forwards",type:13},wow:{backgroundColor:"orange-firetini-50",staticAsset:v,animatedAsset:b,gridAsset:g,label:t.bt("Wow", "Wow", "Reaction label to tell a creator that the pinner was wowed by their pin", undefined, true),htmlStyle:"\n      @keyframes play90 {\n        0% {\n          background-position: 0px 0px;\n        }\n        100% {\n          background-position: -".concat(7380,"px 0px;\n        }\n      }\n    "),animationStyle:"play90 3000ms steps(90) infinite forwards",type:11}};return n&&r[n]?r[n]:r.default}},721332:function(e,t,n){n.r(t),n.d(t,{default:function(){return H}});var r=n(586659),o=n(581722),i=n(20256),a=n(521009),c=n(19585),l=n(675973),s=n(444185),u=n(521907),f=n(352908),d=n(446655),p=n(15667),y=n(382718);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach(function(t){var r,o;r=t,o=n[t],(r=function(e){var t=function(e,t){if("object"!=h(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=h(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==h(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return v(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var w="cubic-bezier(0, 0, 0.58, 1)",x={loaded:{opacity:1,transitionDuration:"0.20s",transitionTimingFunction:w,transitionProperty:"transform, opacity",transform:"translate(0, 5px)",transformOrigin:"center"},fade:{opacity:.1,transitionDuration:"0.30s",transitionTimingFunction:w,transitionProperty:"transform, opacity",transform:"translate(0, 5px)",transformOrigin:"center"}};function _(e){var t=e.reactionLabel,n=e.handleHideConfirmation,o=(0,p.B)().isRTL,a=g((0,r.useState)("loaded"),2),c=a[0],l=a[1],s=g((0,r.useState)({}),2),u=s[0],f=s[1],d=(0,r.useRef)(null),h=(0,r.useRef)(null);return(0,r.useEffect)(function(){if(h.current=requestAnimationFrame(function(){setTimeout(function(){return l("fade")},1e3),setTimeout(function(){return n()},1300)}),d.current){var e=d.current.getBoundingClientRect();(o?e.left<0:e.right>window.innerWidth)&&f(o?{left:0}:{right:0})}},[]),(0,y.jsx)(i.xu,{alignItems:"center",display:"flex",justifyContent:"center",position:"relative",children:(0,y.jsx)(i.xu,{ref:d,alignItems:"center",color:"selected",dangerouslySetInlineStyle:{__style:b(b({},x[c]),{},{whiteSpace:"nowrap"},u)},display:"flex",height:"20px",justifyContent:"center",paddingX:2,paddingY:1,position:"absolute",rounding:"pill",children:(0,y.jsx)(i.xv,{color:"inverse",overflow:"normal",size:"100",weight:"bold",children:t})})})}var j=n(369416),S=n(366859);function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach(function(t){var r,o;r=t,o=n[t],(r=function(e){var t=function(e,t){if("object"!=P(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=P(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==P(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return C(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var T="cubic-bezier(0.25, 0.1, 0.25, 1)",I={icon:{backgroundRepeat:"no-repeat",backgroundSize:"cover"},loading:{opacity:0,transitionDuration:"0.25s",transitionTimingFunction:T,transitionProperty:"transform, opacity",transform:"translateZ(0) translateY(25px) scale(".concat(1.28,")")},loaded:{opacity:1,transitionDuration:"0.25s",transitionTimingFunction:T,transitionProperty:"transform, opacity",transform:"translateZ(0) translateY(0px) scale(".concat(1.28,")")},clicked:{transitionDuration:"0.25s",transitionTimingFunction:T,transitionProperty:"transform",transform:"translateZ(0) translateY(-50px) scale(".concat(1.2,")")},flying:{transitionDuration:"0.25s",transitionTimingFunction:T,transitionProperty:"transform"},label:{transitionDuration:"0.25s",transitionTimingFunction:T,transitionProperty:"transform",transform:"translateZ(0) translateY(0) scale(".concat(.8,")"),whiteSpace:"nowrap"},fading:{opacity:0,transitionDuration:"0.25s",transitionTimingFunction:T}},A={boxShadow:"0 9px 26px rgba(0, 0, 0, 0.4)"};function E(e){var t=e.handleReactionClick,n=e.isCentered,o=e.isIdeaPinCloseUp,l=e.marginTop,s=e.reactionButtonRect,u=e.shouldShowReactionTrayUp,f=e.viewType,p=e.viewParameter,h=e.reactionPickerRef,m=(0,c.Z)(),b=(0,a.Z)(),g=k((0,r.useState)("loading"),2),v=g[0],w=g[1],x=k((0,r.useState)(""),2),_=x[0],P=x[1],O=k((0,r.useState)(),2),C=O[0],T=O[1],E=k((0,r.useState)(),2),D=E[0],z=E[1],B=k((0,r.useState)(!1),2),L=B[0],Z=B[1],U=k((0,r.useState)({}),2),F=U[0],W=U[1],M=(0,r.useRef)(void 0),N=(0,r.useRef)({}),Y=function(){Z(!0);var e=R({},F);d.Jg.forEach(function(t){N.current[t]&&!e[t]&&(e[t]=N.current[t].getBoundingClientRect())}),W(e)},G=function(){var e=R({},C);d.Jg.forEach(function(t){var n=F[t],r=s.left,o=s.top,i=n.left,a=n.top,c=r-i-7+1.25*d.Jg.indexOf(t);e[t]={translateX:c,translateY:o-a-8.5}}),T(e)};(0,r.useEffect)(function(){"loading"===v&&(M.current=requestAnimationFrame(function(){return w("loaded")})),!C&&L&&G()},[L]);var J=function(){document.body&&document.body.style&&(document.body.style.overflow="hidden")},X=function(){document.body&&document.body.style&&(document.body.style.overflow="unset")},H=function(e){var t;return L&&d.Jg.forEach(function(n){var r=F[n];if(r&&r.left&&r.right){var o=r.left,i=r.right;e>=o&&e<=i&&(t=n)}}),t||null},V=function(e){Y(),J();var n=H(e.clientX);n!==_&&n&&(D&&_?b({event_type:105,element:11354,view_type:f,view_parameter:p,aux_data:{reaction_type:(0,d.fW)(n).type,duration:"".concat((Date.now()-D)/1e3," seconds")}}):!D&&_&&z(Date.now()),P(n),w("clicked"),setTimeout(function(){w("flying"),setTimeout(function(){t(n)},800),X()},750))},q=d.Jg.map(function(e,t){var n={transitionDelay:"".concat(.2*(t/d.Jg.length),"s")},r={};C&&(r={transform:"translateZ(0) translateX(".concat(C[e].translateX,"px) translateY(").concat(C[e].translateY,"px) scale(1)")});var o=(0,d.fW)({i18n:m,type:e}),a=o.staticAsset,c=o.animatedAsset,l=o.label,s=o.htmlStyle,u=o.animationStyle;return(0,y.jsx)(i.xu,{alignSelf:"center",display:"flex",children:(0,y.jsx)(i.xu,{dangerouslySetInlineStyle:{__style:{zIndex:e===_&&"clicked"===v?"3":"2"}},children:(0,y.jsxs)(i.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:R(R(R(R(R(R({},"loading"===v||"loaded"===v||_===e&&"clicked"===v||_===e&&"flying"===v?I[v]:{}),_!==e&&("clicked"===v||"flying"===v)?I.loaded:{}),"loading"===v||"loaded"===v?n:{}),_===e&&"flying"===v?r:{}),_!==e&&"flying"===v?I.fading:{}),{},{transformOrigin:"left"})},display:"flex",justifyContent:"center",maxHeight:"flying"===v?24:32,maxWidth:"flying"===v?24:32,position:"relative",children:[_!==e&&(0,y.jsx)(i.xu,{bottom:!0,left:!0,position:"absolute",right:!0,top:!0,children:(0,y.jsx)(i.xu,{dangerouslySetInlineStyle:{__style:{backgroundImage:"url(".concat(a,")"),backgroundPosiiton:"center",backgroundRepeat:"no-repeat",backgroundSize:"cover"}},height:32,width:32})}),(0,y.jsxs)(i.xu,{alignItems:"center",direction:"column",display:"flex",justifyContent:"center",position:"relative",children:[(0,y.jsx)(j.Z,{unsafeCSS:s}),_===e&&"clicked"===v&&(0,y.jsx)(i.xu,{alignItems:"center",color:"selected",dangerouslySetInlineStyle:{__style:I.label},display:"flex",height:20,justifyContent:"center",paddingX:2,paddingY:1,rounding:"pill",children:(0,y.jsx)(i.xv,{color:"inverse",overflow:"normal",size:"100",weight:"bold",children:l})}),(0,y.jsx)(S.Z,{onTouch:V,pressState:"none",children:(0,y.jsx)(i.xu,{ref:function(t){N.current[e]=t},alignItems:"center",dangerouslySetInlineStyle:{__style:R(R(R({},I.icon),_===e&&"clicked"===v?{animation:u}:{}),{},{backgroundImage:"url(".concat(c,")")})},display:"flex",height:_===e&&"flying"!==v?82:"flying"===v?24:32,justifyContent:"center",width:_===e&&"flying"!==v?82:"flying"===v?24:32})})]})]})})},t)});return(0,y.jsx)(i.xu,{children:(0,y.jsx)(i.xu,{ref:h,alignItems:"center",dangerouslySetInlineStyle:{__style:{marginLeft:o?-295:0,marginTop:l||(u?-80:80),userSelect:"none"}},"data-test-id":"reaction-tray",display:"flex",justifyContent:"center",left:!0,position:"absolute",right:void 0!==n&&n,top:!0,children:(0,y.jsx)(i.Le,{top:0,children:(0,y.jsx)(i.xu,{alignItems:"center",color:"flying"===v?"transparent":"default",dangerouslySetInlineStyle:{__style:R(R({},"flying"!==v?A:{}),{},{userSelect:"none"})},display:"flex",height:80,justifyContent:"center",rounding:"pill",width:300,children:(0,y.jsx)(i.xu,{width:"100%",children:(0,y.jsx)(i.xu,{display:"flex",justifyContent:"evenly",onTouchEnd:function(){_&&(w("flying"),setTimeout(function(){t(_)},325)),X()},onTouchMove:function(e){J();var t=H(e.touches[0].clientX);t!==_&&(D&&_&&t&&(0,d.fW)(t)?b({event_type:105,element:11354,view_type:f,view_parameter:p,aux_data:{reaction_type:(0,d.fW)(t).type,duration:"".concat((Date.now()-D)/1e3," seconds")}}):!D&&_&&z(Date.now()),P(t)),w("clicked")},onTouchStart:function(){Y()},children:q})})})})})})}var D=n(581290);function z(e){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach(function(t){G(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Z(e,t,n,r,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function U(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){Z(i,r,o,a,c,"next",e)}function c(e){Z(i,r,o,a,c,"throw",e)}a(void 0)})}}function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,J(r.key),r)}}function W(e,t){return(W=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function M(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(N=function(){return!!e})()}function Y(e){return(Y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function G(e,t,n){return(t=J(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J(e){var t=function(e,t){if("object"!=z(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=z(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==z(t)?t:t+""}var X=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");c.prototype=Object.create(e&&e.prototype,{constructor:{value:c,writable:!0,configurable:!0}}),Object.defineProperty(c,"prototype",{writable:!1}),e&&W(c,e);var t,n,o,a=(t=N(),function(){var e,n=Y(c);return e=t?Reflect.construct(n,arguments,Y(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==z(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return M(e)}(this,e)});function c(e){var t,n;if(!(this instanceof c))throw TypeError("Cannot call a class as a function");return G(M(t=a.call(this,e)),"state",{isReactionTrayShowing:!1,reactionButtonRect:null,showConfirmation:!1,didViewerReact:!1,userReaction:null,isReactionsLoaded:!1}),G(M(t),"trayCloseTimer",null),G(M(t),"observer",null),G(M(t),"reactionPickerRef",(0,r.createRef)()),G(M(t),"handleClickOutside",function(e){var n;t.state.isReactionTrayShowing&&t.reactionPickerRef&&e.target instanceof Element&&!(null!=(n=t.reactionPickerRef.current)&&n.contains(e.target))&&t.setState({isReactionTrayShowing:!1})}),G(M(t),"setReactionButtonRect",function(){if(t.reactionButton){var e,n=t.reactionButton.getBoundingClientRect(),r=n.height,o=n.width,i=n.top,a=n.right,c=document.createElement("div");c.style.height=r+"px",c.style.width=o+"px",c.style.top=i+"px",c.style.right=a+"px",c.style.position="absolute",c.style.zIndex="-1",null==(e=document.body)||e.append(c),t.setState({reactionButtonRect:n})}}),G(M(t),"handleIconPositionChange",function(e){e.forEach(function(e){e.intersectionRatio<1&&t.setReactionButtonRect()})}),G(M(t),"handleScroll",function(){t.state.isReactionTrayShowing&&t.hideReactionTray(),t.setReactionButtonRect()}),G(M(t),"onReactionClick",(n=U(regeneratorRuntime.mark(function e(n){var r,o,i,a,c,l,s,u,f,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=(r=t.props).addReaction,i=r.i18n,a=r.reactionPinId,c=r.userId,l=r.clientTrackingParams,s=r.incrementReactionCount,u=r.onReactionUpdated,f=r.pinId,p=(0,d.fW)({i18n:i,type:n}).type,e.next=4,o(p,a,c,l);case 4:u&&u(),s(f,p),t.handleShowConfirmation();case 7:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)})),G(M(t),"handleShowConfirmation",function(){t.setState({showConfirmation:!0})}),G(M(t),"handleHideConfirmation",function(){t.setState({showConfirmation:!1})}),G(M(t),"handleReactionClick",function(e){t.setState({userReaction:e,didViewerReact:!0},function(){t.onReactionClick(e),t.trayCloseTimer=setTimeout(t.hideReactionTray,250)})}),G(M(t),"hideReactionTray",function(){t.setState({isReactionTrayShowing:!1})}),G(M(t),"handleOneClickReact",function(){var e,n=t.state,r=n.didViewerReact,o=n.userReaction,i=t.props,a=i.removeReaction,c=i.reactionPinId,l=i.userId,s=i.requireAuthForLimitedLogin,u=i.decrementReactionCount,f=i.onReactionUpdated,p=i.pinId,y=i.logContextEvent;r||y({event_type:103,element:11354,object_id_str:t.props.pinId,view_type:3,view_parameter:156}),s({fn:(e=U(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=7;break}return e.next=3,a(c,l);case 3:o&&(u(p,d.bR[o]),f&&f()),t.setState({userReaction:null,didViewerReact:!1}),e.next=8;break;case 7:t.handleReactionClick("love");case 8:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)})})()}),t.reactionPickerRef=(0,r.createRef)(),t.handleClickOutside=t.handleClickOutside.bind(M(t)),t}return n=[{key:"componentDidMount",value:function(){this.observer=new window.IntersectionObserver(this.handleIconPositionChange),this.reactionButton&&this.observer.observe(this.reactionButton),this.setReactionButtonRect(),window.addEventListener("scroll",this.handleScroll),window.addEventListener("mouseover",this.setReactionButtonRect),window.addEventListener("mousedown",this.handleClickOutside)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("mouseover",this.setReactionButtonRect),window.removeEventListener("mousedown",this.handleClickOutside),this.trayCloseTimer&&clearTimeout(this.trayCloseTimer)}},{key:"render",value:function(){var e=this,t=this.state,n=t.isReactionTrayShowing,r=t.reactionButtonRect,o=t.userReaction,a=t.showConfirmation,c=t.didViewerReact,l=this.props,s=l.experience,f=l.i18n,p=l.nativePinType,h=l.hasBackground,m=l.hasReactionTray,b=l.inExpandTapTargetExp,g=l.isIdeaPinCloseUp,v=l.iconColor,w=l.isTextButton,x=l.isTrayPositionRelative,j=(0,d.fW)({i18n:f,type:c&&o?o:"default"}),S=j.animatedAsset,P=j.staticAsset,O=j.label;return(0,y.jsxs)(i.xu,{position:x?"relative":void 0,children:[m&&n&&!!r&&!!r.left&&!!r.top&&(0,y.jsx)(E,{handleReactionClick:this.handleReactionClick,isCentered:!x,isIdeaPinCloseUp:g,marginTop:x?void 0:48,reactionButtonRect:r,reactionPickerRef:this.reactionPickerRef,shouldShowReactionTrayUp:"storyPin"===p,viewParameter:156,viewType:3}),(0,y.jsx)(i.iP,{dataTestId:"react-button",onTap:this.handleOneClickReact,children:void 0!==w&&w?(0,y.jsx)(i.xv,{weight:"bold",children:f.bt("Beri Reaksi", "React", "Closeup.ReactionPicker.Text", undefined, true)}):(0,y.jsx)(i.xu,{ref:m?function(t){e.reactionButton=t}:void 0,alignItems:"center",display:"flex",height:b?40:24,justifyContent:"center",rounding:"circle",width:24,children:c&&o?(0,y.jsx)(i.xu,{dangerouslySetInlineStyle:{__style:{backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundImage:"url(".concat(c&&S?S:P,")")}},height:20,width:20}):(0,y.jsx)(i.hU,{accessibilityLabel:f.bt("Beri Reaksi", "React", "Accessibility label for reacting to a Pin", undefined, true),bgColor:h?"lightGray":"transparent",icon:"heart-outline",iconColor:v||"darkGray",padding:1,size:"xl"})})}),!n&&!a&&!c&&(0,y.jsx)(i.xu,{left:!0,position:"absolute",right:!0,top:!0,children:(0,y.jsx)(u.Z,{color:"blue",eligibleIds:[501979,501996],experience:s,children:function(){return null}})}),a&&!!o&&O&&(0,y.jsx)(_,{handleHideConfirmation:this.handleHideConfirmation,reactionLabel:O})]})}}],o=[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.reactions,r=e.viewer,o=t.isReactionsLoaded;if(n.length>0&&!o){var i=!1,a=0;n.forEach(function(e){var t;r&&"id"in r&&r.id&&e&&(null!=(t=e.user.id)?t:e.user)===r.id&&(i=!0,a=e.reaction_type)});var c=a&&d.GY[a]||"";return{didViewerReact:i,userReaction:c,isReactionsLoaded:!0}}return null}}],n&&F(c.prototype,n),o&&F(c,o),Object.defineProperty(c,"prototype",{writable:!1}),c}(r.PureComponent);function H(e){var t,n=(0,o.I0)();(0,s.Z)({name:"ReactionsResource",options:{pin_id:e.pinId,user_id:e.userId}});var r=(0,o.v9)(function(t){return t.feeds["reactions:".concat(e.pinId)]||[]}),i=(0,o.v9)(function(e){var t=e.reactions;return r.length>0?r.map(function(e){return t[e.id]}):[]}),u=(0,o.v9)(function(e){var t=e.session;return e.users[t.userId]}),d=(0,o.v9)(function(e){return e.session.userId}),p=(0,l.Z)().checkExperiment;return(0,y.jsx)(X,L(L({},e),{},{addReaction:function(t,r,o,i){return n((0,D.Gy)(e.pinId,t,r,o,i))},checkExperiment:p,decrementReactionCount:function(e,t){return n((0,D.Ps)(e,t))},i18n:(0,c.Z)(),incrementReactionCount:function(e,t){return n((0,D.xQ)(e,t))},logContextEvent:(0,a.Z)(),reactionPinId:null!=(t=e.aggregatedPinDataId)?t:"",reactions:i,removeReaction:function(t,r,o){return n((0,D.G3)(e.pinId,t,r,o))},requireAuthForLimitedLogin:(0,f.Z)(),userId:d,viewer:u}))}G(X,"defaultProps",{hasBackground:!1,hasReactionTray:!0,isTrayPositionRelative:!0})},521907:function(e,t,n){n.d(t,{Z:function(){return x}});var r=n(586659),o=n(581722),i=n(20256),a=n(832651),c=n(877956),l=n(366859),s=n(382718),u=["scroll_to_dismiss","scroll_to_dismiss_delay_in_seconds"];function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach(function(t){g(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(m=function(){return!!e})()}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t,n){return(t=v(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){var t=function(e,t){if("object"!=f(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=f(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==f(t)?t:t+""}var w=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");c.prototype=Object.create(e&&e.prototype,{constructor:{value:c,writable:!0,configurable:!0}}),Object.defineProperty(c,"prototype",{writable:!1}),e&&y(c,e);var t,n,o=(t=m(),function(){var e,n=b(c);return e=t?Reflect.construct(n,arguments,b(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==f(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return h(e)}(this,e)});function c(){var e;if(!(this instanceof c))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return g(h(e=o.call.apply(o,[this].concat(n))),"state",{paused:!1,showPulsar:!1,hasMounted:!1}),g(h(e),"handleDismiss",function(){var t=e.props,n=t.onClickDismiss,r=t.dismissExperience,o=t.experience;if(o){var i=o.experience_id;r(o.placement_id,i),n&&n()}}),g(h(e),"wrapperRef",(0,r.createRef)()),e}return n=[{key:"componentDidMount",value:function(){this.props.experience&&(this.mountPulsar(),this.setState({hasMounted:!0}))}},{key:"componentDidUpdate",value:function(e){this.props.experience&&e.experience!==this.props.experience&&(this.mountPulsar(),this.setState({hasMounted:!0}))}},{key:"mountPulsar",value:function(){var e=this.props.experience;e&&e.display_data.has_pulsar&&this.setState({showPulsar:!0})}},{key:"renderPulsar",value:function(){var e=this.wrapperRef,t=this.state.paused;if(!e||!e.current)return null;var n=e.current.getBoundingClientRect(),r=n.height,o=n.width;return(0,s.jsx)(l.Z,{pressState:"none",children:(0,s.jsx)(i.xu,{dangerouslySetInlineStyle:{__style:{marginTop:-(68+r/2),marginLeft:-(68-o/2),pointerEvents:"none"}},position:"absolute",zIndex:new i.Ry(1),children:(0,s.jsx)(i.o3,{paused:t,size:136})})})}},{key:"render",value:function(){var e=this,t=this.props,n=t.children,r=t.eligibleIds,o=t.experience,c=t.idealDirection,l=t.onClickComplete,f=t.textWeight,d=void 0===f?"bold":f,p=t.textAlign,y=t.textOverflow,h=t.fontSize,m=this.state,b=m.showPulsar,g=m.hasMounted;if(!o||!r.includes(o.experience_id)||!g)return n({experience:o});var v=o.display_data,w=v.scroll_to_dismiss,x=v.scroll_to_dismiss_delay_in_seconds,_=void 0===x?0:x,j=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if(({}).hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&({}).propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(v,u);return(0,s.jsx)(a.a3,{eligibleIds:r,experience:o,children:function(t){var r=t.complete,a=t.dismiss,u=function(){return f(),a(),setTimeout(e.handleDismiss,1e3*_)},f=function(){w&&(window.removeEventListener("scroll",u),window.removeEventListener("touchmove",u))};w&&(window.addEventListener("scroll",u),window.addEventListener("touchmove",u));var m=function(){f(),r(1)};return(0,s.jsxs)(i.xu,{ref:e.wrapperRef,children:[n({experience:o}),b?e.renderPulsar():j.has_tooltip&&(0,s.jsx)(i.pl,{anchor:e.wrapperRef.current,idealDirection:c||"down",onDismiss:e.handleDismiss,size:"sm",children:(0,s.jsx)(i.xu,{padding:3,children:(0,s.jsxs)(i.kC,{direction:"column",gap:{row:0,column:3},children:[(0,s.jsx)(i.xu,{column:12,children:(0,s.jsxs)(i.xv,{align:"right"===p?"end":p,color:"light",overflow:y,size:h,weight:d||"bold",children:[j.text,j.secondary_cta_link&&(0,s.jsx)(i.xu,{display:"inlineBlock",marginStart:1,children:(0,s.jsx)(i.xv,{color:"light",size:h,weight:"bold",children:(0,s.jsx)(i.rU,{display:"inlineBlock",href:j.secondary_cta_link.url,target:"blank",underline:"hover",children:j.secondary_cta_link.text})})})]})}),j.complete_button_text&&(0,s.jsx)(i.kC,{alignItems:"stretch",justifyContent:"center",children:j.complete_button_text&&(0,s.jsx)(i.kC,{alignContent:"center",children:(0,s.jsx)(i.zx,{color:"white",onClick:function(){m(),l&&l()},size:"md",text:j.complete_button_text})})})]})})})]})}})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}(c.prototype,n),Object.defineProperty(c,"prototype",{writable:!1}),c}(r.PureComponent);function x(e){var t=(0,o.I0)(),n=(0,c.be)(),r=(0,c.Am)();return(0,s.jsx)(w,p(p({},e),{},{completeExperience:function(e,r){return t(n(e,r))},dismissExperience:function(e,n){return t(r(e,n))}}))}},581290:function(e,t,n){n.d(t,{G3:function(){return f},Gy:function(){return u},Ps:function(){return l},fA:function(){return d},xQ:function(){return s}});var r=n(60101),o=n(575108),i=n(72918),a=n(388023);function c(e,t,n){return{type:"UPDATE_PIN_REACTION_COUNT",payload:{increment:t,reactionType:n,pinId:e}}}function l(e,t){return c(e,!1,t)}function s(e,t){return c(e,!0,t)}var u=function(e,t,n,c,l){return function(s){var u={pin_id:e,user_id:c,reaction_type:t,reaction_pin_id:n,action_type:"reaction",client_tracking_parameters:l},f="ReactionsResource";return o.Z.create(f,u).callUpdate().then(function(e){var t=(0,r.Fv)(e.resource_response.data,a.Z[f]);s((0,i.XM)(f,u,e,t))})}},f=function(e,t,n,c){return function(l){var s={pin_id:e,user_id:n,reaction_pin_id:t,action_type:"unreaction",client_tracking_parameters:c},u="ReactionsResource";return o.Z.create(u,s).callDelete().then(function(e){var t=(0,r.Fv)(e.resource_response.data,a.Z[u]);l((0,i.XM)(u,s,e,t))})}};function d(e,t,n){return{type:"PIN_UPDATE_REACTION_COUNT",payload:{id:e,increment:t,reactionType:n}}}}}]);